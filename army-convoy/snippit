local function spawnPoliceEscort(spawnPoint)
    local policeVehModel = loadModel(convoyConfig.policeModel)
    local copModel = loadModel(convoyConfig.copModel)

    -- Front escort
    local frontX = spawnPoint.x + (convoyConfig.policeFrontOffset * math.cos(math.rad(spawnPoint.w)))
    local frontY = spawnPoint.y + (convoyConfig.policeFrontOffset * math.sin(math.rad(spawnPoint.w)))
    local frontVeh = CreateVehicle(policeVehModel, frontX, frontY, spawnPoint.z, spawnPoint.w, true, true)
    if DoesEntityExist(frontVeh) then
        safeSetVehicleOnGround(frontVeh)
        local frontDriver = CreatePedInsideVehicle(frontVeh, 4, copModel, -1, true, true)
        SetVehicleSiren(frontVeh, true)
        SetVehicleHasMutedSirens(frontVeh, false)
        if DoesEntityExist(frontDriver) and convoyVehicles[1] then
            TaskVehicleEscort(frontDriver, frontVeh, convoyVehicles[1], convoyConfig.speed, convoyConfig.speed, 10.0, 786468, 1.0)
            table.insert(escortVehicles, frontVeh)
            table.insert(escortPeds, frontDriver)
        end
    end

    -- Rear escort
    local rearX = spawnPoint.x + (convoyConfig.policeRearOffset * math.cos(math.rad(spawnPoint.w)))
    local rearY = spawnPoint.y + (convoyConfig.policeRearOffset * math.sin(math.rad(spawnPoint.w)))
    local rearVeh = CreateVehicle(policeVehModel, rearX, rearY, spawnPoint.z, spawnPoint.w, true, true)
    if DoesEntityExist(rearVeh) then
        safeSetVehicleOnGround(rearVeh)
        local rearDriver = CreatePedInsideVehicle(rearVeh, 4, copModel, -1, true, true)
        SetVehicleSiren(rearVeh, true)
        SetVehicleHasMutedSirens(rearVeh, false)
        local lastConvoyVeh = convoyVehicles[#convoyVehicles]
        if DoesEntityExist(rearDriver) and lastConvoyVeh then
            TaskVehicleEscort(rearDriver, rearVeh, lastConvoyVeh, convoyConfig.speed, convoyConfig.speed, 10.0, 786468, 1.0)
            table.insert(escortVehicles, rearVeh)
            table.insert(escortPeds, rearDriver)
        end
    end
end

